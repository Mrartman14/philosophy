(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[341],{49154:(e,t,r)=>{Promise.resolve().then(r.bind(r,63058))},63058:(e,t,r)=>{"use strict";r.d(t,{default:()=>R});var n=r(95155),l=r(12115);async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,[r]=await Promise.all([e,new Promise(e=>setTimeout(e,t))]);return r}let i=e=>(0,n.jsxs)("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,n.jsx)("path",{d:"M4 4C4 3.44772 4.44772 3 5 3H14H14.5858C14.851 3 15.1054 3.10536 15.2929 3.29289L19.7071 7.70711C19.8946 7.89464 20 8.149 20 8.41421V20C20 20.5523 19.5523 21 19 21H5C4.44772 21 4 20.5523 4 20V4Z",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round"}),(0,n.jsx)("path",{d:"M20 8H15V3",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M12 9L12 17",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M9 14L12 17L15 14",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round"})]}),s=e=>(0,n.jsxs)("svg",{width:"1em",height:"1em",fill:"none",viewBox:"-1 0 24 24",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,n.jsx)("path",{d:"M4,3 L4,4.77236651 C4,5.96625907 4.64816908,7.08665789 5.74030881,7.78059385 L18.2596912,15.735299 C19.3518309,16.429235 20,17.5496338 20,18.7435264 L20,21 L4,21 L4,18.7435264 C4,17.5496338 4.64816908,16.429235 5.74030881,15.735299 L18.2596912,7.78059385 C19.3518309,7.08665789 20,5.96625907 20,4.77236651 L20,3 L4,3 Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M11.7926812,9.17832792 L7.66910673,6.04502868 C7.49560596,5.91319407 7.44778491,5.64439211 7.56229541,5.4446427 C7.63196026,5.32312099 7.74997665,5.25 7.87644635,5.25 L16.1235953,5.25 C16.3314779,5.25 16.5,5.44401757 16.5,5.68335038 C16.5,5.82895346 16.4364877,5.96482435 16.3309349,6.04502868 L12.2073604,9.17832792 C12.0815952,9.27389069 11.9184464,9.27389069 11.7926812,9.17832792 Z",fill:"currentColor"})]});var o=r(76435),c=r(10822),d=r(49641).Buffer;async function h(e){var t;let r,n,l,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i="".concat("https://mrartman14.github.io/philosophy").concat(e.path),s=await fetch(i),h=(t=s.headers.get("Content-Disposition"))&&t.includes("filename=")?t.split("filename=")[1].replace(/['"]/g,"").trim():null,u=await s.arrayBuffer(),m=u.byteLength,p={};a?p.buffer=d.from(u):p.arrayBuffer=u;let{value:f}=await (0,o.aY)({...p},{includeEmbeddedStyleMap:!1,ignoreEmptyParagraphs:!0,idPrefix:"parsed-docx-",styleMap:["comment-reference => sup.".concat(g),"u => span.underline.decoration-1","p[style-name='Quote'] => blockquote:fresh","highlight[color='yellow'] => span.bg-amber-700","highlight[color='green'] => span.bg-green-700","highlight[color='cyan'] => span.bg-cyan-700","highlight[color='magenta'] => span.bg-pink-700","highlight[color='blue'] => span.bg-blue-700","highlight[color='red'] => span.bg-red-700","highlight[color='darkYellow'] => span.bg-yellow-700","highlight[color='darkGreen'] => span.bg-green-700","highlight[color='darkCyan'] => span.bg-cyan-700","highlight[color='darkMagenta'] => span.bg-pink-700","highlight[color='darkBlue'] => span.bg-blue-700","highlight[color='darkRed'] => span.bg-red-700","highlight[color='black'] => span.bg-black","highlight[color='white'] => span.bg-white"]});if(a)throw Error("not implemented yet!");{let e=c.A.sanitize(f),t=new DOMParser().parseFromString(e,"text/html");l=function(e){let t=Array.from(e.querySelectorAll("h1, h2, h3, h4, h5, h6")).map(e=>{var t;let r=null!=(t=e.textContent)?t:"",n=null!=r?r:"".normalize("NFKD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,""),l=parseInt(e.tagName[1],10);return e.id=n,{id:n,text:r,level:l,depth:0}}),r=[];return t.forEach(e=>{for(;r.length&&r[r.length-1]>=e.level;)r.pop();r.push(e.level),e.depth=r.length-1}),t}(t),n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:225,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12;return Math.ceil(e.replace(/<\/?[^>]+(>|$)/g,"").trim().split(/\s+/).filter(Boolean).length/t+(e.match(/<img [^>]*src="[^"]*"[^>]*>/g)||[]).length*r/60)}(r=t.body.innerHTML,200)}return{id:e.name,htmlString:r,headingsData:l,meta:{readingTime:n},fileMeta:{fileName:h,fileSizeInBytes:m}}}let g="docx-comment-reference";var u=r(91959),m=r.n(u);let p=e=>{let{items:t,className:r}=e,a=(0,l.useRef)(null),i=(0,l.useRef)(null),[s,o]=(0,l.useState)(!1),[c,d]=(0,l.useState)();return(0,l.useLayoutEffect)(()=>{var e;d(null==(e=t[0])?void 0:e.id)},[t]),(0,l.useLayoutEffect)(()=>{var e;let r=m()(()=>{let e=[];for(let r of(t.forEach(t=>{let{id:r}=t,n=document.getElementById(r);n&&e.push({el:n,id:r})}),e)){let{top:e,left:t}=r.el.getBoundingClientRect();if(e>=0&&t>=0){if(d(r.id),a.current){let e=a.current.getBoundingClientRect(),t=document.getElementById(x(r.id)).getBoundingClientRect(),n=a.current.scrollTop+(t.top-e.top)-16;a.current.scrollTo({top:n,behavior:"smooth"})}break}}},100);return r(),null==(e=document)||e.addEventListener("scroll",r),()=>{var e;null==(e=document)||e.removeEventListener("scroll",r)}},[t]),(0,l.useEffect)(()=>{let e=a.current,t=i.current;if(!e||!t)return;let r=getComputedStyle(e).top||"0px",n=new IntersectionObserver(e=>{let[t]=e;o(!t.isIntersecting)},{root:null,threshold:0,rootMargin:"-".concat(r," 0px 0px 0px")});return n.observe(t),()=>n.disconnect()},[]),(0,n.jsxs)("aside",{className:"w-full h-full grid content-start ".concat(r),children:[(0,n.jsx)("div",{className:"px-4 border-b border-(--border) flex items-center",style:{height:40,minHeight:40,maxHeight:40},children:(0,n.jsx)("h3",{className:"text-(--description) font-semibold",children:"Содержание"})}),(0,n.jsx)("div",{ref:i,style:{height:1,margin:0,padding:0}}),(0,n.jsx)("ul",{ref:a,className:"grid p-4 sticky top-(--header-height) self-start overflow-y-scroll",style:{maxHeight:s?"calc(100vh - var(--header-height))":"calc(100vh - var(--header-height) - ".concat(40,"px)")},children:t.map(e=>(0,n.jsx)(f,{item:e,depth:0,intersected:c},e.id))})]})},f=e=>{var t;let{item:r,depth:l,intersected:a}=e,i=a===r.id;return(0,n.jsxs)("li",{children:[(0,n.jsx)("a",{href:"#".concat(r.id),id:x(r.id),className:"".concat(i?"":"text-(--description)"," hover:underline"),children:r.render({isSelected:i,depth:l})},r.id),null==(t=r.children)?void 0:t.map(e=>(0,n.jsx)(f,{item:e,depth:l+1,intersected:a},e.id))]})};function x(e){return"".concat(e,"-anchor")}let w=e=>(0,n.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{d:"M9 6L12 3M12 3L15 6M12 3V13M7.00023 10C6.06835 10 5.60241 10 5.23486 10.1522C4.74481 10.3552 4.35523 10.7448 4.15224 11.2349C4 11.6024 4 12.0681 4 13V17.8C4 18.9201 4 19.4798 4.21799 19.9076C4.40973 20.2839 4.71547 20.5905 5.0918 20.7822C5.5192 21 6.07899 21 7.19691 21H16.8036C17.9215 21 18.4805 21 18.9079 20.7822C19.2842 20.5905 19.5905 20.2839 19.7822 19.9076C20 19.4802 20 18.921 20 17.8031V13C20 12.0681 19.9999 11.6024 19.8477 11.2349C19.6447 10.7448 19.2554 10.3552 18.7654 10.1522C18.3978 10 17.9319 10 17 10",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round"})}),v=e=>{let{shareData:{title:t,url:r,text:l},className:a="",iconClassName:i="",children:s}=e,o=async()=>{let e=null!=r?r:window.location.href;if(navigator.share)try{await navigator.share({title:t,text:l,url:e})}catch(e){console.error(e)}else try{await navigator.clipboard.writeText(e)}catch(e){console.error(e)}};return(0,n.jsxs)("button",{onClick:o,"aria-label":"Поделиться",className:"flex items-center ".concat(a),children:[s,(0,n.jsx)(w,{className:i})]})},b=e=>{let{className:t,targetElementId:r}=e,[a,i]=(0,l.useState)(0);return(0,l.useEffect)(()=>{let e=document.getElementById(r);if(!e)return;let t=()=>{let t=e.getBoundingClientRect(),r=window.innerHeight,n=e.offsetHeight,l=window.scrollY+t.top;i(100*Math.min(Math.max((window.scrollY-l)/(n-r),0),1))};return t(),window.addEventListener("scroll",t),window.addEventListener("resize",t),()=>{window.removeEventListener("scroll",t),window.removeEventListener("resize",t)}},[r]),(0,n.jsx)("div",{className:"".concat("function"==typeof t?t(a):t),children:(0,n.jsx)("div",{className:"h-full bg-(--primary)",style:{width:"".concat(a,"%")}})})};var j=r(45299),C=r(84945),y=r(41093),k=r(6874),N=r.n(k),L=r(45964),E=r.n(L),M=r(35695);let S=e=>(0,n.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{d:"M4 2h11v2H6v13H4V2zm4 4h12v16H8V6zm2 2v12h8V8h-8z",fill:"currentColor"})}),B=e=>{let{enabled:t=!0}=e,[r,a]=(0,l.useState)(""),[i,s]=(0,l.useState)(!1),o=(0,l.useRef)(null),c=(0,M.useSearchParams)(),{refs:d,floatingStyles:h,update:g}=(0,j.we)({middleware:[(0,C.cY)(10),(0,C.UU)(),(0,C.BN)()],whileElementsMounted:y.ll,placement:"bottom-end"});return(0,l.useEffect)(()=>{t&&c.has("selection")&&setTimeout(()=>{!function(e){if(!e)return;let t=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,{acceptNode(t){var r;return(null==(r=t.nodeValue)?void 0:r.includes(e))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}}).nextNode();if(t&&t.nodeValue){let r=t.nodeValue.indexOf(e);if(-1!==r){let n=document.createRange();n.setStart(t,r),n.setEnd(t,r+e.length);let l=document.createElement("span");l.id="highlighted",l.className="text-selection-highlight",l.textContent=e,n.deleteContents(),n.insertNode(l),o.current=l,d.setReference(l),g(),l.scrollIntoView({behavior:"smooth",block:"center"}),s(!0),a(e)}}}(c.get("selection"))},500)},[c,t,d,g]),(0,l.useEffect)(()=>{if(!t)return;let e=E()(()=>{let e=window.getSelection();if(e&&e.rangeCount>0&&!e.isCollapsed){let t=e.getRangeAt(0).getClientRects();if(t.length>0){let r=t[t.length-1],n={getBoundingClientRect:()=>r,contextElement:document.body};d.setReference(n),g(),s(!0),a(e.toString());return}}s(!1),a("")},200);return document.addEventListener("selectionchange",e),()=>{document.removeEventListener("selectionchange",e)}},[t,d,g]),i&&(0,n.jsxs)("div",{ref:d.setFloating,style:h,className:"z-50 bg-(--background) border-2 border-(--border) rounded-xl grid overflow-hidden",children:[(0,n.jsx)(v,{className:"flex items-center justify-between gap-2 p-2 hover:bg-(--text-pane)",iconClassName:"text-2xl",shareData:{title:"selected text",url:"".concat(window.location.href,"?selection=").concat(r)},children:(0,n.jsx)("span",{children:"Поделиться отрывком"})}),(0,n.jsxs)("button",{className:"flex items-center justify-between gap-2 p-2 hover:bg-(--text-pane)",children:[(0,n.jsx)("span",{children:"Ссылка на отрывок"}),(0,n.jsx)(N(),{href:"".concat(window.location.href,"?selection=").concat(r),children:(0,n.jsx)(S,{className:"text-2xl"})})]})]})};function H(e){let{className:t=""}=e;return(0,n.jsx)("div",{className:"bg-gray-300 dark:bg-gray-700 rounded animate-pulse \n            text-base leading-7 h-[1em] ".concat(t),style:{minHeight:"1em"}})}let T=e=>{let{cols:t=4,rows:r=10,className:a}=e,i=[...Array(r)].map(()=>(function(e){let t=[],r=e;for(;r>0;){if(1===r){t.push(1);break}let e=Math.floor(Math.random()*(r-1))+1;t.push(e),r-=e}return t})(t));return(0,n.jsx)("div",{className:"tractate grid grid-cols-".concat(t," gap-4 w-full min-h-full ").concat(null!=a?a:""),style:{gridTemplateColumns:"repeat(".concat(t,",1fr)")},children:i.map((e,t)=>(0,n.jsx)(l.Fragment,{children:e.map((e,r)=>(0,n.jsx)(H,{className:"col-span-".concat(e)},"".concat(t,"-").concat(r)))},t))})},R=e=>{let{data:t}=e,[r,o]=(0,l.useState)(!1),[c,d]=(0,l.useState)([]),[g,u]=(0,l.useState)({headingsData:[],htmlString:"",id:t.name,fileMeta:{fileName:null,fileSizeInBytes:null},meta:{readingTime:0}});(0,l.useEffect)(()=>{o(!0),a(h(t),300).then(e=>{u(e)}).finally(()=>{o(!1)})},[t]);let m="".concat("https://mrartman14.github.io/philosophy").concat(t.path);(0,l.useEffect)(()=>{d(g.headingsData.map(e=>({id:e.id,render:t=>{let{isSelected:r}=t;return(0,n.jsxs)("span",{className:"grid gap-4 grid-rows-1 ".concat(r?"":"text-(--description)"),style:{gridTemplateColumns:"repeat(".concat(e.depth,", 1px) 1fr")},children:[[...Array(e.depth)].map((e,t)=>(0,n.jsx)("div",{className:"bg-(--border)"},t)),(0,n.jsx)("span",{className:"py-1",children:e.text})]})}})))},[g.headingsData]);let f=t.name;return(0,n.jsxs)(n.Fragment,{children:[!r&&(0,n.jsx)(b,{className:e=>"sticky top-(--header-height) z-50 md:col-span-2 ".concat(e>0?"h-1":"h-0"),targetElementId:f}),(0,n.jsxs)("div",{className:"w-full grid grid-cols-1 md:grid-cols-[1fr_300px]",children:[(0,n.jsxs)("div",{className:"grid gap-4 p-4 border-(--border) border-b md:border-r",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2 text-md",children:[(0,n.jsxs)("span",{className:"flex items-center gap-2 text-(--description)",children:[(0,n.jsx)(s,{"aria-label":"Среднее время чтения",className:"text-(--description)"}),g.meta.readingTime," мин."]}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)("a",{download:!0,href:m,"aria-label":"Скачать файл",className:"flex items-center gap-2 text-xl text-(--description) hover:text-inherit",children:(0,n.jsx)(i,{})}),(0,n.jsx)(v,{className:"text-xl text-(--description) hover:text-inherit",shareData:{title:g.id}})]})]}),r?(0,n.jsx)(T,{rows:50}):(0,n.jsx)("article",{id:f,className:"w-full tractate",dangerouslySetInnerHTML:{__html:g.htmlString}})]}),(0,n.jsx)(B,{}),(0,n.jsx)(p,{items:c,className:"hidden md:grid"})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[545,874,94,697,441,684,358],()=>t(49154)),_N_E=e.O()}]);