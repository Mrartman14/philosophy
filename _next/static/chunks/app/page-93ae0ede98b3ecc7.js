(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{198:(e,t,s)=>{"use strict";let n,r;s.d(t,{P2:()=>f});let a=(e,t)=>t.some(t=>e instanceof t),i=new WeakMap,o=new WeakMap,l=new WeakMap,c={get(e,t,s){if(e instanceof IDBTransaction){if("done"===t)return i.get(e);if("store"===t)return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return d(e[t])},set:(e,t,s)=>(e[t]=s,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function d(e){if(e instanceof IDBRequest){let t=new Promise((t,s)=>{let n=()=>{e.removeEventListener("success",r),e.removeEventListener("error",a)},r=()=>{t(d(e.result)),n()},a=()=>{s(e.error),n()};e.addEventListener("success",r),e.addEventListener("error",a)});return l.set(t,e),t}if(o.has(e))return o.get(e);let t=function(e){if("function"==typeof e)return(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(u(this),t),d(this.request)}:function(...t){return d(e.apply(u(this),t))};return(e instanceof IDBTransaction&&function(e){if(i.has(e))return;let t=new Promise((t,s)=>{let n=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",a),e.removeEventListener("abort",a)},r=()=>{t(),n()},a=()=>{s(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",r),e.addEventListener("error",a),e.addEventListener("abort",a)});i.set(e,t)}(e),a(e,n||(n=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(e,c):e}(e);return t!==e&&(o.set(e,t),l.set(t,e)),t}let u=e=>l.get(e);function f(e,t,{blocked:s,upgrade:n,blocking:r,terminated:a}={}){let i=indexedDB.open(e,t),o=d(i);return n&&i.addEventListener("upgradeneeded",e=>{n(d(i.result),e.oldVersion,e.newVersion,d(i.transaction),e)}),s&&i.addEventListener("blocked",e=>s(e.oldVersion,e.newVersion,e)),o.then(e=>{a&&e.addEventListener("close",()=>a()),r&&e.addEventListener("versionchange",e=>r(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}let p=["get","getKey","getAll","getAllKeys","count"],h=["put","add","delete","clear"],g=new Map;function w(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(g.get(t))return g.get(t);let s=t.replace(/FromIndex$/,""),n=t!==s,r=h.includes(s);if(!(s in(n?IDBIndex:IDBObjectStore).prototype)||!(r||p.includes(s)))return;let a=async function(e,...t){let a=this.transaction(e,r?"readwrite":"readonly"),i=a.store;return n&&(i=i.index(t.shift())),(await Promise.all([i[s](...t),r&&a.done]))[0]};return g.set(t,a),a}c=(e=>({...e,get:(t,s,n)=>w(t,s)||e.get(t,s,n),has:(t,s)=>!!w(t,s)||e.has(t,s)}))(c);let m=["continue","continuePrimaryKey","advance"],v={},x=new WeakMap,I=new WeakMap,y={get(e,t){if(!m.includes(t))return e[t];let s=v[t];return s||(s=v[t]=function(...e){x.set(this,I.get(this)[t](...e))}),s}};async function*b(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let s=new Proxy(t,y);for(I.set(s,t),l.set(s,u(t));t;)yield s,t=await (x.get(s)||t.continue()),x.delete(s)}function L(e,t){return t===Symbol.asyncIterator&&a(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&a(e,[IDBIndex,IDBObjectStore])}c=(e=>({...e,get:(t,s,n)=>L(t,s)?b:e.get(t,s,n),has:(t,s)=>L(t,s)||e.has(t,s)}))(c)},1497:(e,t,s)=>{Promise.resolve().then(s.bind(s,91975)),Promise.resolve().then(s.bind(s,14453))},14453:(e,t,s)=>{"use strict";s.d(t,{LessonsSlider:()=>c});var n=s(95155),r=s(6874),a=s.n(r);s(12115),s(38163);let i=e=>{let{items:t,itemClassName:s,secondsPerItem:r=4}=e;return(0,n.jsx)("div",{className:"infinite-slider",children:(0,n.jsx)("div",{className:"infinite-slider-track gap-4",style:{animationDuration:"".concat(r*t.length,"s")},children:t.map((e,t)=>(0,n.jsx)("div",{className:"".concat(s),children:e},t))})})};var o=s(53558),l=s(95664);let c=()=>{let{lectures:e}=(0,l.i)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("h2",{className:"flex gap-2",children:[(0,n.jsx)(a(),{href:"/lectures",className:"font-bold",children:"Все лекции"}),"→"]}),(0,n.jsx)(i,{itemClassName:"shrink-0 grow-0 basis-[200px] md:basis-[300px]",items:e.map(e=>(0,n.jsx)(o.Z,{lesson:e,className:"h-[150px] md:h-[200px]"},e.slug))})]})}},38163:()=>{},53558:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var n=s(95155),r=s(6874),a=s.n(r),i=s(66766);let o=e=>{let{lesson:t,className:s}=e;return(0,n.jsxs)(a(),{href:"/lectures/".concat(t.slug),className:"".concat(s," flex group relative rounded-xl border-4 border-(--border) overflow-hidden"),children:[(0,n.jsx)(i.default,{fill:!0,alt:"Lecture cover",src:"".concat("/philosophy").concat(t.cover),style:{margin:0},className:"object-cover transition-transform duration-500 scale-150 group-hover:scale-100 group-focus:scale-100"}),(0,n.jsx)("div",{className:"absolute p-0.5 bottom-2 right-0 w-full bg-(--text-pane)",children:(0,n.jsx)("h3",{className:"text-md md:text-2xl whitespace-nowrap text-ellipsis overflow-hidden",style:{margin:0},children:t.title})})]})}},66587:(e,t,s)=>{"use strict";s.d(t,{o:()=>l});var n=s(198);let r="lessons",a={lastCount:"lastCount",viewed:"viewed",lastViewedLessonIds:"lastViewedLessonIds"},i=async()=>(0,n.P2)("lessonDB",1,{upgrade(e){e.objectStoreNames.contains(r)||e.createObjectStore(r)}});class o{async getLastLessonsCount(){var e;let t=await i();return null!=(e=await t.get(r,a.lastCount))?e:0}async setLastLessonsCount(e){let t=await i();await t.put(r,e,a.lastCount)}async getViewedLessonIds(){var e;let t=await i();return null!=(e=await t.get(r,a.viewed))?e:[]}async markLessonViewed(e){let t=await i(),s=await this.getViewedLessonIds();s.includes(e)||(s.push(e),await t.put(r,s,a.viewed))}async getLastViewedLessonIds(){var e;let t=await i();return null!=(e=await t.get(r,a.lastViewedLessonIds))?e:[]}async setLastViewedLessonId(e){var t;let s=await i(),n=null!=(t=await s.get(r,a.lastViewedLessonIds))?t:[];(n=n.filter(t=>t!==e)).push(e),n.length>3&&(n=n.slice(n.length-3)),await s.put(r,n,a.lastViewedLessonIds)}}let l=new o},66766:(e,t,s)=>{"use strict";s.d(t,{default:()=>r.a});var n=s(71469),r=s.n(n)},71469:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{default:function(){return l},getImageProps:function(){return o}});let n=s(88229),r=s(38883),a=s(33063),i=n._(s(51193));function o(e){let{props:t}=(0,r.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/philosophy/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,s]of Object.entries(t))void 0===s&&delete t[e];return{props:t}}let l=a.Image},91975:(e,t,s)=>{"use strict";s.d(t,{LastViewedLesson:()=>l});var n=s(95155),r=s(12115),a=s(53558),i=s(66587),o=s(95664);let l=()=>{let{lectures:e}=(0,o.i)(),[t,s]=(0,r.useState)([]);return(0,r.useEffect)(()=>{!async function(){let t=await i.o.getLastViewedLessonIds();0!==t.length&&s(e.filter(e=>t.includes(e.slug)))}()},[e]),t.length>0?(0,n.jsxs)("section",{children:[(0,n.jsx)("h2",{children:"История посещений"}),(0,n.jsx)("div",{className:"width-full gap-4 flex flex-nowrap overflow-scroll",children:t.map(e=>(0,n.jsx)(a.Z,{lesson:e,className:"grow-0 shrink-0 basis-[200px] md:basis-[300px] h-[150px] md:h-[200px]"},e.slug))})]}):null}},95664:(e,t,s)=>{"use strict";s.d(t,{AppPageClientProvider:()=>i,i:()=>o});var n=s(95155),r=s(12115);let a=(0,r.createContext)({exams:[],lectures:[]}),i=e=>{let{children:t,pageConfig:s}=e;return(0,n.jsx)(a,{value:s,children:t})},o=()=>(0,r.useContext)(a)}},e=>{var t=t=>e(e.s=t);e.O(0,[426,874,63,441,684,358],()=>t(1497)),_N_E=e.O()}]);